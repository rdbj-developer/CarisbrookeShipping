<style type="text/css">
    table > thead > tr > td {
        border: 1px solid #66afe9 !important;
        padding: 1px !important;
    }

    .SectionHead {
        border: 1px solid #66afe9 !important
    }

    .CRAGeneralSection {
        min-height: 430px;
    }

    #cyberContainer {
        -webkit-transform: translate3d(0, 0, 0);
        transform: translate3d(0, 0, 0);
    }
</style>

<script>
    var LastReviwedDateTime = '@ViewBag.LastReviwedDateTime';
    $(document).ready(function () {
        //ShowLastReviewedDate();
    });

    function ShowLastReviewedDate() {
        document.getElementById('spanLastReviewedDateTime').innerHTML = LastReviwedDateTime;
        document.getElementById('divLastReviewedDateTime').classList.remove('hide');
    }
</script>

<div class="row">
    <div class="col-md-12">
        @if (Model != null && Model.CybersecurityRisksAssessmentForm != null)
        {
            <input type="hidden" id="hdnRemovedCRALId" name="CybersecurityRisksAssessmentForm.RemovedCRALId" />
            <input type="hidden" value="@Model.CybersecurityRisksAssessmentForm.CreatedBy" name="CybersecurityRisksAssessmentForm.CreatedBy" id="hdnCreatedBy" />
            <input type="hidden" value="@Model.CybersecurityRisksAssessmentForm.CreatedDate" name="CybersecurityRisksAssessmentForm.CreatedDate" id="hdnCreatedDate" />
            <input type="hidden" value="@Model.CybersecurityRisksAssessmentForm.CRAId" name="CybersecurityRisksAssessmentForm.CRAId" id="hdnCRAId" />
            <input type="hidden" value="@Model.CybersecurityRisksAssessmentForm.ShipName" name="CybersecurityRisksAssessmentForm.ShipName" id="hdnShipName" />

            @* JSL 01/12/2023 added class hide *@
            <div class="aviodPrint hide">Last synced: @Model.CybersecurityRisksAssessmentForm.UpdatedDate</div>

            @* JSL 01/12/2023 added reviwed *@
            <div class="aviodPrint">Last reviewed: @Convert.ToDateTime(Model.CybersecurityRisksAssessmentForm.UpdatedDate).ToShortDateString()</div>
        }
        <div class="GeneralSection PageSection CRAGeneralSection drag" id="#dragCyber">
            <div class="breakDiv">
                <div class="SectionContent" id="cyberContainer">
                    <table class="tblSection tblCRAEquipment" id="tblCRAEquipment">
                        <thead style="border: 1px solid #66afe9 !important; ">
                            <tr>
                                <td width="6%" rowspan="2">
                                </td>
                                <td width="94%" colspan="21" style="text-align:center">Assess Risks</td>
                            </tr>
                            <tr>
                                <td width="94%" colspan="21" style="text-align:center">Formally identified and owned risks are initially assessed as inherent, thisis because the control landscape may change over time so there should be a base level of the risk to re-assess against. The inherent impact and likelihood is assessed against the CIA triad to generate the inherent score. Current controls are then put against the risk to generate the residual risk. If this residual risk is higher than defined risk appetite, then the risk is put forward to risk treatment.</td>
                            </tr>
                            <tr class="theadBackColor">
                                <td rowspan="2" class="h-tooltip" title="This column contains the list of IT&OT Assets affected by the risk. 'Hover over' Hardware ID to see the full name of the asset">Hardware ID</td>
                                <td width="6%"  class="h-tooltip" rowspan="2" title="Unique reference of the risk">Risk ID</td>
                                <td rowspan="2" class="h-tooltip" title="Short description of the risk created in accordance to ISO 27001 standard. Some examples include: 'breakdown of communication links' - risks related to data transmission or communication. Eavesdropping - collecting of information using network 'sniffing' or 'snooping' techniques">Risk Description</td>
                                <td rowspan="2" class="h-tooltip" title="The type of vulnerability discovered">Vulnerability</td>
                                <td colspan="4" class="h-tooltip" title="This column indicates the areas of impact for each risk (C-Confidentiality, I-Integrity, A-Availability, S-Safety)">Inherent <br />Impact/risk category</td>
                                <td rowspan="2" class="h-tooltip custom-width" title="Impact Score">Impact <br /> score</td>
                                <td rowspan="2" class="h-tooltip" title="Likelihood Score">Likelihood <br /> score</td>
                                <td rowspan="2" class="h-tooltip bg-red custom-width" title="Inherent Risk Score">Inherent risk <br /> score</td>
                                <td rowspan="2" class="h-tooltip" title="Measures used to mitigate the risk. Please refer to Cyber Security Plan for more details (references to SMS, IT procedures and policies)">Controls</td>
                                <td colspan="4" class="h-tooltip" title="This column indicates the areas of impact for each risk (C-Confidentiality, I-Integrity, A-Availability, S-Safety)">Residual<br />Impact/risk category</td>
                                <td rowspan="2" class="h-tooltip custom-width" title="Impact Score">Impact <br /> score</td>
                                <td rowspan="2" class="h-tooltip custom-width" title="Likelihood Score">Likelihood <br /> score</td>
                                <td rowspan="2" class="h-tooltip bg-red custom-width" title="Residual Risk Score">Residual risk <br /> score</td>
                                <td rowspan="2" class="h-tooltip" title="Risk Decision">Risk decision</td>
                                <td rowspan="2" class="h-tooltip" title="Risk Owner">Risk Owner</td>
                                <td rowspan="2" class="h-tooltip" title="Remove"></td>
                            </tr>
                            <tr class="theadBackColor">
                                <td class="h-tooltip" title="C">C</td>
                                <td class="h-tooltip" title="I">I</td>
                                <td class="h-tooltip" title="A">A</td>
                                <td class="h-tooltip" title="S">S</td>
                                <td class="h-tooltip" title="C">C</td>
                                <td class="h-tooltip" title="I">I</td>
                                <td class="h-tooltip" title="A">A</td>
                                <td class="h-tooltip" title="S">S</td>
                            </tr>
                        </thead>
                        <tbody>
                            @if (@Model == null || @Model.CybersecurityRisksAssessmentListModal == null || @Model.CybersecurityRisksAssessmentListModal.Count <= 0)
                            {
                                <tr class="records" index="0" IsSelected="true" style="width:100%">
                                    <td class="word-wrap">
                                        <select class="editable-select CRAData" multiple="multiple" data-placeholder="Select..." name="CybersecurityRisksAssessmentListModal[0].HardwareIdList">
                                            @if (Model.HardwareListBoxValues != null)
                                            {
                                                foreach (var item in (List<string>)Model.HardwareListBoxValues)
                                                {
                                                    <option value="@item">@item</option>
                                                }
                                            }
                                        </select>
                                        <div style="padding: 5px; float:right; ">
                                            <button type="button" class="btn btn-sm btn-primary" onclick="copyHardwareIds(this)">Copy</button>
                                            <button type="button" class="btn btn-sm btn-primary" onclick="pasteHardwareIds(this)">Paste</button>
                                        </div>
                                    </td>
                                    <td class="">
                                        <input type="text" class="CRAData textRow form-control riskid-width" rows="1" autocomplete="off" name="CybersecurityRisksAssessmentListModal[0].RiskId" />
                                    </td>
                                    <td class="">
                                        <div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">
                                            <textarea class="k-input CRAData textRow" rows="1" autocomplete="off"
                                                      name="CybersecurityRisksAssessmentListModal[0].RiskDescription"></textarea>
                                            <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">
                                                <span class="k-icon k-i-arrow-chevron-down"></span>
                                            </span>
                                            <ul class="dropdown-menu selectbox">
                                                @if (TempData["RiskList"] != null)
                                                {
                                                    foreach (var items in (List<string>)TempData["RiskList"])
                                                    {
                                                        <li><a href="javascript:void(0)">@items</a></li>
                                                    }
                                                }
                                            </ul>
                                        </div>
                                    </td>
                                    <td class="">
                                        <div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">
                                            <textarea class="k-input form-control CRAData textRow" rows="1" autocomplete="off"
                                                      name="CybersecurityRisksAssessmentListModal[0].Vulnerability"></textarea>
                                            <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">
                                                <span class="k-icon k-i-arrow-chevron-down"></span>
                                            </span>
                                            <ul class="dropdown-menu selectbox">
                                                @if (TempData["VulnerabilityList"] != null)
                                                {
                                                    foreach (var items in (List<string>)TempData["VulnerabilityList"])
                                                    {
                                                        <li><a href="javascript:void(0)">@items</a></li>
                                                    }
                                                }
                                            </ul>
                                        </div>
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryC" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryC" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryI" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryI" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryA" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryA" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryS" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].InherentRiskCategoryS" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentImpactScore" onchange="onChangeCalculateRiskScore(this,true)">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[0].InherentLikelihoodScore" onchange="onChangeCalculateRiskScore(this,true)">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <input type="hidden" class="custom-width" name="CybersecurityRisksAssessmentListModal[0].InherentRiskScore" value="Low" />
                                        <p class="m-5 text-center bg-green-active custom-width">Low</p>
                                    </td>
                                    <td class="word-wrap">
                                        <select class="editable-select CRAData" multiple="multiple" data-placeholder="Select..." name="CybersecurityRisksAssessmentListModal[0].ControlsList">
                                            @if (TempData["ControlsList"] != null)
                                            {
                                                foreach (var item in (List<string>)TempData["ControlsList"])
                                                {
                                                    <option value="@item">@item</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryC" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryC" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryI" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryI" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryA" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryA" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryS" value="true" />
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskCategoryS" value="false" />
                                    </td>
                                    <td class="text-center">
                                        <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualImpactScore" onchange="onChangeCalculateRiskScore(this)">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[0].ResidualLikelihoodScore" onchange="onChangeCalculateRiskScore(this)">
                                            <option value="1">1</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                        </select>
                                    </td>
                                    <td class="text-center">
                                        <input type="hidden" name="CybersecurityRisksAssessmentListModal[0].ResidualRiskScore" value="Low" /> <p class="m-5 text-center bg-green-active custom-width">Low</p>
                                    </td>
                                    <td class="word-wrap">
                                        <select class="col-md-12 form-control CRAData riskDecision" name="CybersecurityRisksAssessmentListModal[0].RiskDecision">
                                            <option value=""></option>
                                            @if (TempData["RiskDecisionList"] != null)
                                            {
                                                foreach (var item in (List<string>)TempData["RiskDecisionList"])
                                                {
                                                    <option value="@item">@item</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td class="word-wrap">
                                        <textarea class="CRAData textRow" rows="1" autocomplete="off" name="CybersecurityRisksAssessmentListModal[0].RiskOwner"></textarea>
                                    </td>
                                    <td width="2%" class="text-center aviodPrint noExl">
                                        <p>
                                            <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                        </p>
                                    </td>
                                </tr>
                            }
                            else
                            {
                                int count1 = 0;
                                int impactScore, reseduleScore;
                                for (int j = 0; j < Model.CybersecurityRisksAssessmentListModal.Count; j++)
                                {
                                    var item = Model.CybersecurityRisksAssessmentListModal[j];
                                    impactScore = item.ImpactScore; 
                                    if (impactScore <= 3)
                                    {
                                        item.InherentRiskScore = "Low";
                                        item.InherentClass = "bg-green-active";
                                    }
                                    else if (impactScore > 3 && impactScore <= 6)
                                    {
                                        item.InherentRiskScore = "Medium";
                                        item.InherentClass = "bg-yellowtext";
                                    }
                                    else if (impactScore > 6 && impactScore <= 9)
                                    {
                                        item.InherentRiskScore = "High";
                                        item.InherentClass = "bg-yellow-active";
                                    }
                                    else if (impactScore > 9 && impactScore <= 16)
                                    {
                                        item.InherentRiskScore = "Very high";
                                        item.InherentClass = "bg-red";
                                    }
                                    reseduleScore = item.ReseduleScore; 
                                    if (reseduleScore <= 3)
                                    {
                                        item.ResidualRiskScore = "Low";
                                        item.ResidualClass = "bg-green-active";
                                    }
                                    else if (reseduleScore > 3 && reseduleScore <= 6)
                                    {
                                        item.ResidualRiskScore = "Medium";
                                        item.ResidualClass = "bg-yellowtext";
                                    }
                                    else if (reseduleScore > 6 && reseduleScore <= 9)
                                    {
                                        item.ResidualRiskScore = "High";
                                        item.ResidualClass = "bg-yellow-active";
                                    }
                                    else if (reseduleScore > 9 && reseduleScore <= 16)
                                    {
                                        item.ResidualRiskScore = "Very high";
                                        item.ResidualClass = "bg-red";
                                    }
                                    <tr class="records" index="@count1" IsSelected="true">
                                        <td>
                                            <input type="hidden" class="IsUpdated" value="false" name="CybersecurityRisksAssessmentListModal[@count1].IsUpdated" />
                                            <input type="hidden" class="CRALId" value="@item.CRALId" name="CybersecurityRisksAssessmentListModal[@count1].CRALId" />
                                            <select class="editable-select CRAData HardwareIdList" multiple="multiple" data-placeholder="Select..."
                                                    name="CybersecurityRisksAssessmentListModal[@count1].HardwareIdList" data-val="@item.HardwareId">
                                                <option>ALL</option>                                                
                                            </select>
                                            <div style="padding: 5px; float:right; ">
                                                <button type="button" class="btn btn-sm btn-primary" onclick="copyHardwareIds(this)">Copy</button>
                                                <button type="button" class="btn btn-sm btn-primary" onclick="pasteHardwareIds(this)">Paste</button>
                                            </div>
                                        </td>
                                        <td class="word-wrap">
                                            <input type="text" class="CRAData textRow riskid-width form-control" autocomplete="off" value="@item.RiskId" name="CybersecurityRisksAssessmentListModal[@count1].RiskId" />
                                        <td class="word-wrap">
                                            <div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">
                                                <textarea class="k-input CRAData textRow" rows="1" autocomplete="off"
                                                          name="CybersecurityRisksAssessmentListModal[@count1].RiskDescription">@item.RiskDescription</textarea>
                                                <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">
                                                    <span class="k-icon k-i-arrow-chevron-down"></span>
                                                </span>
                                                <ul class="dropdown-menu selectbox ulRiskDescription">                                                    
                                                </ul>
                                            </div>
                                        </td>
                                        <td class="word-wrap">
                                            <div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">
                                                <textarea class="k-input  CRAData textRow" rows="1" autocomplete="off"
                                                          name="CybersecurityRisksAssessmentListModal[@count1].Vulnerability">@item.Vulnerability</textarea>
                                                <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">
                                                    <span class="k-icon k-i-arrow-chevron-down"></span>
                                                </span>
                                                <ul class="dropdown-menu selectbox ulVulnerability">                                                    
                                                </ul>
                                            </div>
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.InherentRiskCategoryC) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryC" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryC" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.InherentRiskCategoryI) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryI" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryI" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.InherentRiskCategoryA) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryA" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryA" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.InherentRiskCategoryS) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryS" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskCategoryS" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <select class="col-md-12 custom-width form-control CRAData" name="CybersecurityRisksAssessmentListModal[@count1].InherentImpactScore" onchange="onChangeCalculateRiskScore(this,true)">
                                                <option @(item.InherentImpactScore == "1" ? "selected" : "") value="1">1</option>
                                                <option @(item.InherentImpactScore == "2" ? "selected" : "") value="2">2</option>
                                                <option @(item.InherentImpactScore == "3" ? "selected" : "") value="3">3</option>
                                                <option @(item.InherentImpactScore == "4" ? "selected" : "") value="4">4</option>
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <select class="col-md-12 custom-width form-control CRAData" name="CybersecurityRisksAssessmentListModal[@count1].InherentLikelihoodScore" onchange="onChangeCalculateRiskScore(this,true)">
                                                <option @(item.InherentLikelihoodScore == "1" ? "selected" : "") value="1">1</option>
                                                <option @(item.InherentLikelihoodScore == "2" ? "selected" : "") value="2">2</option>
                                                <option @(item.InherentLikelihoodScore == "3" ? "selected" : "") value="3">3</option>
                                                <option @(item.InherentLikelihoodScore == "4" ? "selected" : "") value="4">4</option>
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].InherentRiskScore" value="@item.InherentRiskScore" /><p class="m-5 text-center custom-width @item.InherentClass">@item.InherentRiskScore</p>
                                        </td>
                                        <td class="word-wrap">
                                            <select class="editable-select CRAData Controls" data-val="@item.Controls" multiple="multiple" data-placeholder="Select..." name="CybersecurityRisksAssessmentListModal[@count1].ControlsList">                                                
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.ResidualRiskCategoryC) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryC" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryC" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.ResidualRiskCategoryI) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryI" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryI" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.ResidualRiskCategoryA) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryA" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryA" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <input type="checkbox" class="CRAData" value="true" @(Convert.ToBoolean(item.ResidualRiskCategoryS) ? "checked" : "") name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryS" />
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskCategoryS" value="false" />
                                        </td>
                                        <td class="text-center">
                                            <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[@count1].ResidualImpactScore" onchange="onChangeCalculateRiskScore(this)">
                                                <option @(item.ResidualImpactScore == "1" ? "selected" : "") value="1">1</option>
                                                <option @(item.ResidualImpactScore == "2" ? "selected" : "") value="2">2</option>
                                                <option @(item.ResidualImpactScore == "3" ? "selected" : "") value="3">3</option>
                                                <option @(item.ResidualImpactScore == "4" ? "selected" : "") value="4">4</option>
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[@count1].ResidualLikelihoodScore" onchange="onChangeCalculateRiskScore(this)">
                                                <option @(item.ResidualLikelihoodScore == "1" ? "selected" : "") value="1">1</option>
                                                <option @(item.ResidualLikelihoodScore == "2" ? "selected" : "") value="2">2</option>
                                                <option @(item.ResidualLikelihoodScore == "3" ? "selected" : "") value="3">3</option>
                                                <option @(item.ResidualLikelihoodScore == "4" ? "selected" : "") value="4">4</option>
                                            </select>
                                        </td>
                                        <td class="text-center">
                                            <input type="hidden" name="CybersecurityRisksAssessmentListModal[@count1].ResidualRiskScore" value="@item.ResidualRiskScore" /><p class="m-5 text-center custom-width @item.ResidualClass">@item.ResidualRiskScore</p>
                                        </td>
                                        <td class="word-wrap">
                                            <select class="col-md-12 form-control CRAData riskDecision" data-id="@item.CRALId" data-val="@item.RiskDecision" name="CybersecurityRisksAssessmentListModal[@count1].RiskDecision">                                                
                                            </select>
                                        </td>
                                        <td class="word-wrap">
                                            <textarea style="width:100px" class="CRAData textRow" rows="1" autocomplete="off" value="@item.RiskOwner" name="CybersecurityRisksAssessmentListModal[@count1].RiskOwner">@item.RiskOwner</textarea>
                                        </td>
                                        <td width="2%" class="text-center aviodPrint noExl">
                                            <p>
                                                <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                            </p>
                                        </td>
                                    </tr>
                                    count1++;
                                }
                            }
                        </tbody>
                    </table>
                    <br />
                    <div class="col-md-12 aviodPrint">
                        <a href="#" id="lnkAddAssessRisk">Add RISK ASSESS</a>
                    </div>
                    <br />
                    <br />
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var scrolled = 0;
    $(document).ready(function () {
        InitAllLists();
        $("textarea").each(function (textarea) {
            $(this).width($(this)[0].scrollWidth);
        });
        bindCombobox();
        bindAddNewRowEvents();
        bindTextareaOnInputEvent();
        bindScrollEvent();
        $("#lnkAddAssessRisk").off('click').on("click", function () {
            var jsonObjHWList = @Html.Raw(Json.Encode(TempData["HardwareList"]));
             if (jsonObjHWList) {
                 hardwareListCyber = "";
                 $.each(jsonObjHWList, function (i, item) {
                     hardwareListCyber += '<option value="' + item + '">' + item + '</option>';
                 });
             }
            $(".tblCRAEquipment").find(".records").css('background-color', '#ffffff !important');
            $(".tblCRAEquipment").find(".records").attr('IsSelected', 'false');
            var count = parseInt($(".tblCRAEquipment").find(".records").length);
            var newguid = generateGUID();
            var strTemplate = '<tr class="records" index="' + count + '" IsSelected="true">'
                + '<td>	'
                + '<input type="hidden" class="IsUpdated" value="true" name="CybersecurityRisksAssessmentListModal[' + count + '].IsUpdated" /> '
                + '<input type="hidden" class="CRALId" value="' + newguid+ '" name="CybersecurityRisksAssessmentListModal[' + count + '].CRALId" />'
                + '    <select class="editable-select CRAData" multiple="multiple" data-placeholder="Select..." id="HardwareList_' + count + '" name="CybersecurityRisksAssessmentListModal[' + count + '].HardwareIdList">	'
                + hardwareListCyber
                + '    </select>	'
                +' <div style = "padding: 5px; float:right; " > '
                + '  <button type="button" class="btn btn-sm btn-primary" onclick="copyHardwareIds(this)">Copy</button> '
                +'<button type="button" class="btn btn-sm btn-primary" onclick="pasteHardwareIds(this)">Paste</button>'
                +'</div> '
                + '</td>	'
                + '<td class="word-wrap"><input type="text" class="CRAData textRow form-control riskid-width" autocomplete="off" name="CybersecurityRisksAssessmentListModal[' + count + '].RiskId"/></td>'
                + '<td class="word-wrap">	'
                + '<div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">'
                + '                                <textarea class="k-input CRAData textRow" rows="1" autocomplete="off"'
                + '                                         name="CybersecurityRisksAssessmentListModal[' + count + '].RiskDescription"></textarea>'
                + '                               <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">'
                + '                                   <span class="k-icon k-i-arrow-chevron-down"></span>'
                + '                               </span>'
                + '                               <ul class="dropdown-menu selectbox">'
                + riskList
                + '                              </ul>'
                + '</div>'
                + '</td>	'
                + '<td class="word-wrap">	'
                + '<div tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default new-group">'
                + '                                <textarea class="k-input CRAData textRow" rows="1" autocomplete="off"'
                + '                                    name="CybersecurityRisksAssessmentListModal[' + count + '].Vulnerability"></textarea>'
                + '                               <span unselectable="on" class="k-select edit" data-toggle="dropdown" aria-label="select" role="button" tabindex="-1">'
                + '                                   <span class="k-icon k-i-arrow-chevron-down"></span>'
                + '                               </span>'
                + '                               <ul class="dropdown-menu selectbox">'
                + vulnerabilityList
                + '                              </ul>'
                + '                           </div>'
                + '</td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryC" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryC" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryI" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryI" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryA" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryA" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryS" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskCategoryS" value="false" /></td>	'
                + '<td class="text-center custom-width">'
                + '<select class="col-md-12 form-control custom-width  CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentImpactScore" onchange="onChangeCalculateRiskScore(this,true)">'
                + '    <option value="1">1</option>'
                + '    <option value="2">2</option>'
                + '    <option value="3">3</option>'
                + '    <option value="4">4</option>'
                + '</select>                        '
                + '                </td>'
                + '<td class="text-center custom-width">'
                + '    <select class="col-md-12 form-control custom-width  CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentLikelihoodScore" onchange="onChangeCalculateRiskScore(this,true)">'
                + '        <option value="1">1</option>'
                + '        <option value="2">2</option>'
                + '        <option value="3">3</option>'
                + '        <option value="4">4</option>'
                + '    </select>'
                + '</td>'
                + '<td class="text-center custom-width">'
                + '    <input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].InherentRiskScore" value="Low" />'
                + '    <p class="m-5 text-center custom-width  bg-green-active">Low</p>'
                + '</td>'
                + '<td class="word-wrap">'
                + '    <select class="editable-select CRAData" multiple="multiple" data-placeholder="Select..."  name="CybersecurityRisksAssessmentListModal[' + count + '].ControlsList">	'
                + controlsList
                + '    </select>	'
                + '</td>'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryC" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryC" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryI" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryI" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryA" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryA" value="false" /></td>	'
                + '<td class="text-center"><input type="checkbox" class="CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryS" value="true" /><input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskCategoryS" value="false" /></td>	'
                + '<td class="text-center custom-width">'
                + '<select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualImpactScore" onchange="onChangeCalculateRiskScore(this)">'
                + '    <option value="1">1</option>'
                + '    <option value="2">2</option>'
                + '    <option value="3">3</option>'
                + '    <option value="4">4</option>'
                + '</select>'
                + '</td>'
                + '<td class="text-center custom-width">'
                + '    <select class="col-md-12 form-control custom-width CRAData" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualLikelihoodScore" onchange="onChangeCalculateRiskScore(this)">'
                + '        <option value="1">1</option>'
                + '        <option value="2">2</option>'
                + '        <option value="3">3</option>'
                + '        <option value="4">4</option>'
                + '    </select>'
                + '</td>'
                + '<td class="text-center custom-width">'
                + '    <input type="hidden" name="CybersecurityRisksAssessmentListModal[' + count + '].ResidualRiskScore" value="Low" />'
                + '    <p class="m-5 text-center bg-green-active">Low</p>'
                + '</td>'
                + '<td>	'
                + '    <select class="col-md-12 form-control CRAData riskDecision" name="CybersecurityRisksAssessmentListModal[' + count + '].RiskDecision">	'
                + riskDecisionList
                + '    </select>	'
                + '</td>	'
                + '<td class="word-wrap"><textarea  rows="1" class="CRAData  textRow" autocomplete="off" name="CybersecurityRisksAssessmentListModal[' + count + '].RiskOwner"></textarea></td>	'
                + '<td width="2%" class="text-center aviodPrint noExl">	'
                + '    <p>	'
                + '        <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>	'
                + '    </p>	'
                + '</td>	'
                + ' </tr>';
            $(".tblCRAEquipment").append(strTemplate);
            bindAddNewRowEvents();
            bindCombobox(true);
            bindTextareaOnInputEvent();
            bindScrollEvent();
        });
        var elementScroll = document.getElementById('#dragCyber');
        elementScroll.addEventListener("mousedown", function (e) {
            this.sx = this.scrollLeft;
            mx = e.pageX - this.offsetLeft;

            this.addEventListener("mousemove", mouseMoveFunctionCyber);
        });

        elementScroll.addEventListener("mouseup", function (e) {
            this.removeEventListener("mousemove", mouseMoveFunctionCyber);
            mx = 0;
        });

        function InitAllLists() {
            var str = "";
            var cyberData =  @Html.Raw(Json.Encode(Model));
            if (cyberData.HardwareListBoxValues) {
                str = "";
                var lstHardwareListBoxValues = cyberData.HardwareListBoxValues;
                for (var i = 0; i < lstHardwareListBoxValues.length; i++) {
                    str += '<option value="' + lstHardwareListBoxValues[i].split("|")[0] + '">' + lstHardwareListBoxValues[i] + '</option>';
                }
                $(".HardwareIdList").append(str);
            }
            var lstRiskDecisionList =  @Html.Raw(Json.Encode(TempData["RiskDecisionList"]));
            if (lstRiskDecisionList) {
                str = '<option value=""></option>';
                for (var i = 0; i < lstRiskDecisionList.length; i++) {
                    str += '<option value="' + lstRiskDecisionList[i]  + '">' + lstRiskDecisionList[i] + '</option>';
                }
                $(".riskDecision").append(str);
                var dataList = cyberData.CybersecurityRisksAssessmentListModal;
                var CRALId = "";
                $(".riskDecision").each(function () {
                    CRALId = $(this).attr("data-id");
                    var filterdata = $.grep(dataList, function (n, i) {
                        return (n.CRALId == CRALId);
                    });
                    if (filterdata && filterdata.length>0) {
                        $(this).val($(this).attr("data-val"));
                    }
                });
            }
            var lstRiskList =  @Html.Raw(Json.Encode(TempData["RiskList"]));
            if (lstRiskList) {
                str = '';
                for (var i = 0; i < lstRiskList.length; i++) {
                    str += '<li><a href="javascript:void(0)">' + lstRiskList[i] + '</a></li>';
                }
                $(".ulRiskDescription").append(str);
            }
            var lstVulnerabilityList =  @Html.Raw(Json.Encode(TempData["VulnerabilityList"]));
            if (lstVulnerabilityList) {
                str = '';
                for (var i = 0; i < lstVulnerabilityList.length; i++) {
                    str += '<li><a href="javascript:void(0)">' + lstVulnerabilityList[i] + '</a></li>';
                }
                $(".ulVulnerability").append(str);
            }
            var lstControlsList =  @Html.Raw(Json.Encode(TempData["ControlsList"]));
            if (lstControlsList) {
                str = '';
                for (var i = 0; i < lstControlsList.length; i++) {
                    str += '<option value="' + lstControlsList[i] + '">' + lstControlsList[i] + '</option>';
                }
                $(".Controls").append(str);
            }
        }
        $("#tblCRAEquipment").kendoTooltip({
            filter: ".h-tooltip",
            width: 250,
            position: "bottom",
            animation: {
                open: {
                    effects: "zoom",
                    duration: 100
                }
            },
            "background-color": "red"
        }).data("kendoTooltip");
    });


</script>