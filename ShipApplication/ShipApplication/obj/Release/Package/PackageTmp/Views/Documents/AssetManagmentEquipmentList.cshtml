@using ShipApplication.BLL.Modals
@model AssetManagmentEquipmentListModal
@{
    ViewBag.Title = "AssetManagmentEquipmentList";
}
<link href="~/Content/Custom/GIRForm.css" rel="stylesheet" />
<style type="text/css">
    .fa-fw {
        background-color: #FFFFE1;
        padding: 2px;
    }

    .fa-plus {
        color: green;
    }

    .fa-remove {
        color: red;
    }

    .actionToolbar {
        margin-bottom: 0px;
        display: flex;
        justify-content: space-around;
        align-items: stretch;
    }

    .divar {
        background: #66afe9;
        width: 1px;
    }

    .cursor-pointer {
        cursor: pointer;
    }

    .Section {
        border: none;
    }

    table thead tr td {
        border: 1px solid #66afe9 !important;
        padding: 1px !important;
    }

    .SectionHead {
        border: 1px solid #66afe9 !important
    }
    .minWidthSmall {
        min-width: 135px;
    }

</style>
<script type="text/javascript">
    var criticalityList = "";
    $(document).ready(function () {
         var res = '@ViewBag.result';
        if (res == '@AppStatic.SUCCESS') {
            $.notify("Form Updated Successfully", "success");
        }
        else if (res == '@AppStatic.ERROR') {
            $.notify("Error occured while submitting Form !", "error");
        }
        else if (res != "") {
            $.notify(res, "warn");
        }
        var jsonObjCriticalityList = @Html.Raw(Json.Encode(TempData["CriticalityList"]));
        criticalityList = "<option value=''></option>";
        $.each(jsonObjCriticalityList, function (i, item) {
            criticalityList += '<option value="' + item +'">' + item + '</option>';
        });
        bindAddNewRowEvents();
        $("#lnkAddOTEquipment").on("click", function () {
            $(".tblOTEquipment").find(".records").css('background-color', '#ffffff !important');
            $(".tblOTEquipment").find(".records").attr('IsSelected', 'false');
            var count = parseInt($(".tblOTEquipment").find(".records").length);
            var strTemplate = '<tr class="records" index="' + count + '" IsSelected="true">'
                + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData" value="OT'+pad(count+1, 5)+'" name="AssetManagmentEquipmentOTListModel[' + count + '].OTHardwareId" /> '
                + ' </td> '
                + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTEquipment" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTLocation" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTMake" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTModel" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTType" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTSerialNo" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTWorkingCondition" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTLastServiced" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTRemark" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTOwner" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTPersonResponsible" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '  <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentOTListModel[' + count + '].OTCriticality"> '
                + criticalityList
                + '  </select>'
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTOperatingSystem" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[' + count + '].OTOSPatchVersion" /> '
                + ' </td> '
                //+ ' <td width="2%" class="text-center aviodPrint"> '
                //+ '   <p> '
                //+ '       <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span> '
                //+ '   </p> '
                //+ ' </td> '
                + ' </tr>';
            $(".tblOTEquipment").append(strTemplate);
            bindAddNewRowEvents();
        });
        $("#lnkAddITEquipment").on("click", function () {
            $(".tblITEquipment").find(".records").css('background-color', '#ffffff !important');
            $(".tblITEquipment").find(".records").attr('IsSelected', 'false');
            var count = parseInt($(".tblITEquipment").find(".records").length);
            var strTemplate = '<tr class="records" index="' + count + '" IsSelected="true">'
                 + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData" value="IT'+pad(count+1, 5)+'" name="AssetManagmentEquipmentITListModel[' + count + '].ITHardwareId" /> '
                + ' </td> '
                + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITEquipment" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITLocation" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITMake" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITModel" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITType" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITSerialNo" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITWorkingCondition" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITLastServiced" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITRemark" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITOwner" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITPersonResponsible" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '  <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentITListModel[' + count + '].ITCriticality"> '
                + criticalityList
                + '  </select>'
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITOperatingSystem" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentITListModel[' + count + '].ITOSPatchVersion" /> '
                + ' </td> '
                //+ ' <td width="2%" class="text-center aviodPrint"> '
                //+ '   <p> '
                //+ '       <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span> '
                //+ '   </p> '
                //+ ' </td> '
                + ' </tr>';
            $(".tblITEquipment").append(strTemplate);
            bindAddNewRowEvents();
        });
        $("#lnkAddSoftwareAssets").on("click", function () {
            $(".tblSoftwareAssets").find(".records").css('background-color', '#ffffff !important');
            $(".tblSoftwareAssets").find(".records").attr('IsSelected', 'false');
            var count = parseInt($(".tblSoftwareAssets").find(".records").length);
            var strTemplate = '<tr class="records" index="' + count + '" IsSelected="true">'
                + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData" value="SA'+pad(count+1, 5)+'"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SASoftwareId" /> '
                + ' </td> '
                + ' <td width="11%">'
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].Name" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].Manufacturer" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].LicenseType" /> '
                + ' </td> '
                + ' <td width="11%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].Category" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].IsActive" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SAOwner" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SAPersonResponsible" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '  <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SACriticality"> '
                + criticalityList
                + '  </select>'
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SAOperatingSystem" /> '
                + ' </td> '
                + ' <td width="10%"> '
                + '   <input type="text" class="col-md-12 form-control AMEData"  name="AssetManagmentEquipmentSoftwareAssetsModel[' + count + '].SAOSPatchVersion" /> '
                + ' </td> '
                //+ ' <td width="2%" class="text-center aviodPrint"> '
                //+ '   <p> '
                //+ '       <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span> '
                //+ '   </p> '
                //+ ' </td> '
                + ' </tr>';
            $(".tblSoftwareAssets").append(strTemplate);
            bindAddNewRowEvents();
        });
    });
    function removeRecord(obj) {
        var istblOTEquipment = false;
        if ($(obj).closest("table").hasClass("tblOTEquipment")) {
            istblOTEquipment = true;
        }
         var istblITEquipment = false;
        if ($(obj).closest("table").hasClass("tblITEquipment")) {
            istblITEquipment = true;
        }
         var istblSoftwareAssets = false;
        if ($(obj).closest("table").hasClass("tblSoftwareAssets")) {
            istblSoftwareAssets = true;
        }
        $(obj).closest("tr").remove();

        //Reindex all rows
        if (istblOTEquipment) {
            var trRows = $('.tblOTEquipment tr.records');
            $.each(trRows, function (key, trvalue) {
                var rows = $(trvalue).find("input");
                $.each(rows, function (tdkey, value) {
                    var valArr = value.name.split(".");
                    value.name = "AssetManagmentEquipmentOTListModel[" + parseInt(key) + "]." + valArr[1];
                });
            });
        }
        else if (istblITEquipment) {
          var trItRows = $('.tblITEquipment tr.records');
                $.each(trItRows, function (key, trvalue) {
                    var rows = $(trvalue).find("input");
                    $.each(rows, function (tdkey, value) {
                        var valArr = value.name.split(".");
                        value.name = "AssetManagmentEquipmentITListModel[" + parseInt(key) + "]." + valArr[1];
                    });
                });
        }
        else if (istblSoftwareAssets) {
             var trItRows = $('.tblSoftwareAssets tr.records');
                    $.each(trItRows, function (key, trvalue) {
                        var rows = $(trvalue).find("input");
                        $.each(rows, function (tdkey, value) {
                            var valArr = value.name.split(".");
                            value.name = "AssetManagmentEquipmentSoftwareAssetsModel[" + parseInt(key) + "]." + valArr[1];
                        });
                    });
        }
        AMEAutoSave();
    }

     function printDiv() {
        var RootUrl = '@Url.Content("~/")';
        $("input[type=text]").each(function () {
            var str = $(this).val();
            $(this).attr('value', str);
        });
        $(".dt").attr("style", "padding-right : 0px !important");
        $(".aviodPrint").hide();
         var style = "@@media print {.breakDivPage { page-break-after: always; page-break-inside:auto   } body { zoom: .8 } }";
        style += "@@page {size: auto;margin: 4%;}";
         style += ".Section {border: none;} .SectionHead {border: 1px solid #66afe9;border-bottom: none;}";
         style += " table thead tr td { border: 1px solid #66afe9 !important; }";

          var divToPrint = document.getElementById('frmOTITEquipmentListContent').innerHTML;
         $("#frmAssetManagementEquipmentContentPrint").show();
         $("#Printtable tbody").empty();
         var divToPrint1 = $("#Printtable tbody").append("<tr><td  style='border-width: 0px !important;'>" + divToPrint + "</td></tr>");
        divToPrint = document.getElementById('frmAssetManagementEquipmentContentPrint').innerHTML;
        $("#frmOTITEquipmentListContent").hide();
        var newWin = window.open('', 'Print-Window');
        newWin.document.open();
        newWin.document.write('<html><head><title></title>');
        newWin.document.write('<style type="text/css">' + style + '</style>');
        newWin.document.write('<link href="' + RootUrl+'Content/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />');
        newWin.document.write('<link href="' + RootUrl +'Content/AdminLTE.min.css" rel="stylesheet" />');
        newWin.document.write('<link href="' + RootUrl +'Content/_all-skins.min.css" rel="stylesheet" />');
        newWin.document.write('<link href="' + RootUrl +'Content/Custom/SiteCustom.css" rel="stylesheet" />');
        newWin.document.write('<link rel="stylesheet" href="' + RootUrl +'Content/Custom/GIRForm.css" type="text/css" />');
        newWin.document.write('</head><body onload="window.print()">');

        newWin.document.write(divToPrint);
        newWin.document.write('</body></html>');
         $("#frmAssetManagementEquipmentContentPrint").hide();
         $("#frmOTITEquipmentListContent").show();
         $(".aviodPrint").show();

        newWin.document.close();
        setTimeout(function () { newWin.close(); }, 5000);

    }
    function AMEAutoSave() {
    var url ='@Url.Action("AssetManagmentEquipmentAutoSave", "Documents")';
    $("#lblAutoSave").show();
    var form = $("#formContent");
    $.ajax({
        url: url,
        type: 'POST',
        data: form.serialize(),
        async: true,
        success: function (res) {
            console.log(res);
            $("#hdnAMEId").val(res);
            $("#lblAutoSave").hide();
        },
        error: function (err) {
            console.log(err);
            $("#lblAutoSave").hide();
        }
    });
}
    function bindAddNewRowEvents() {
        $(".AMEData").bind("change", function () {
            AMEAutoSave();
        });
    }
    function pad(n, width, z) {
        //pad(10, 4);      // 0010
        //pad(9, 4);       // 0009
        //pad(123, 4);     // 0123
        //pad(10, 4, '-'); // --10
        z = z || '0';
        n = n + '';
        return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
    }
    function exportAssets() {
        window.location = '@Url.Action("DownloadAssetManagmentEquipmentList", "Documents")';
    }
</script>
<section class="content">
    <form method="post" id="formContent" action="@Url.Action("AssetManagmentEquipmentList", "Documents")">
        <div id="frmOTITEquipmentListContent">
            <input type="hidden" value="5" id="hdnHoldVentilationRecordCount" />
            <input type="hidden" value="@ShipApplication.BLL.Helpers.SessionManager.ShipCode" name="AssetManagmentEquipmentListForm.ShipCode" id="hdnHVRShipCode" />
            <input type="hidden" value="@ShipApplication.BLL.Helpers.SessionManager.ShipName" name="AssetManagmentEquipmentListForm.ShipName" id="hdnHVRShipName" />
            @if (@Model != null && @Model.AssetManagmentEquipmentListForm != null)
            {
                <input type="hidden" value="@Model.AssetManagmentEquipmentListForm.CreatedBy" name="AssetManagmentEquipmentListForm.CreatedBy" id="hdnCreatedBy" />
                <input type="hidden" value="@Model.AssetManagmentEquipmentListForm.CreatedDate" name="AssetManagmentEquipmentListForm.CreatedDate" id="hdnCreatedDate" />
                <input type="hidden" value="@Model.AssetManagmentEquipmentListForm.AMEId" name="AssetManagmentEquipmentListForm.AMEId" id="hdnAMEId" />
            }
            <div class="row aviodPrint">
                <div class="col-md-3">
                </div>
                <div class="col-md-6 text-center">
                    <h3>Asset Management - IT & OT Equipment</h3>
                </div>
            </div>
            <br />
            <div class="row aviodPrint">
                <div class="col-md-6">
                    <h4>SHIP: @ShipApplication.BLL.Helpers.SessionManager.ShipName</h4>
                </div>
            </div>
            <br />
            <div class="row aviodPrint">
                <div class="col-md-12 text-center"><label id="lblAutoSave" style="display:none;">Saving...</label></div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="GeneralSection PageSection">
                        <div class="breakDiv">
                            <div class="SectionContent">
                                <table class="table tblSection tblOTEquipment">
                                    <thead style="border: 1px solid #66afe9 !important;">
                                        <tr style="border: 1px solid #66afe9 !important;">
                                            <td class="SectionHead text-center" colspan="16" style="border: 1px solid #66afe9 !important;">
                                                OT EQUIPMENT
                                            </td>
                                        </tr>
                                        <tr style="border: 1px solid #66afe9 !important;">
                                            <td width="11%"><p class="m-5 text-center">HARDWARE ID</p></td>
                                            <td width="11%"><p class="m-5 text-center">EQUIPMENT</p></td>
                                            <td width="11%"><p class="m-5 text-center">LOCATION</p></td>
                                            <td width="11%"><p class="m-5 text-center">MAKE</p></td>
                                            <td width="11%"><p class="m-5 text-center">MODEL</p></td>
                                            <td width="10%"><p class="m-5 text-center">TYPE</p></td>
                                            <td width="11%"><p class="m-5 text-center">SERIAL NO</p></td>
                                            <td width="10%"><p class="m-5 text-center">WORKING CONDITION</p></td>
                                            <td width="7%"><p class="m-5 text-center">LAST SERVICED</p></td>
                                            <td width="16%"><p class="m-5 text-center">REMARKS</p></td>
                                            <td width="11%"><p class="m-5 text-center">OWNER</p></td>
                                            <td width="11%"><p class="m-5 text-center">PERSON RESPONSIBLE</p></td>
                                            <td width="11%"><p class="m-5 text-center">CRITICALITY</p></td>
                                            <td width="11%"><p class="m-5 text-center">OPERATING SYSTEM</p></td>
                                            <td width="11%"><p class="m-5 text-center">OS PATCH VERSION</p></td>
                                            @*<td width="2%" class="aviodPrint"></td>*@
                                        </tr>
                                    </thead>
                                    @if (@Model == null || @Model.AssetManagmentEquipmentOTListModel == null || @Model.AssetManagmentEquipmentOTListModel.Count <= 0)
                                    {
                                <tr class="records" index="0" IsSelected="true">
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="OT00001" name="AssetManagmentEquipmentOTListModel[0].OTHardwareId" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTEquipment" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTLocation" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTMake" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTModel" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTType" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTSerialNo" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTWorkingCondition" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTLastServiced" />
                                    </td>
                                    <td width="16%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTRemark" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTOwner" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTPersonResponsible" />
                                    </td>
                                    <td width="11%">
                                        <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentOTListModel[0].OTCriticality">
                                            <option value=""></option>
                                            @if (TempData["CriticalityList"] != null)
                                            {
                                                foreach (var item in (List<string>)TempData["CriticalityList"])
                                                {
                                                    <option value="@item">@item</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTOperatingSystem" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentOTListModel[0].OTOSPatchVersion" />
                                    </td>
                                    <td width="2%" class="text-center aviodPrint">
                                        <p>
                                            <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                        </p>
                                    </td>
                                </tr>
                                    }
                                    else
                                    {
                                        int count1 = 0;
                                        foreach (var item in Model.AssetManagmentEquipmentOTListModel)
                                        {
                                <tr class="records" index="@count1" IsSelected="true">
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value=" @(!string.IsNullOrEmpty(item.OTHardwareId) ? item.OTHardwareId :  "OT" + (count1+1).ToString().PadLeft(5,'0'))" name="AssetManagmentEquipmentOTListModel[@count1].OTHardwareId" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTEquipment" name="AssetManagmentEquipmentOTListModel[@count1].OTEquipment" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTLocation" name="AssetManagmentEquipmentOTListModel[@count1].OTLocation" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTMake" name="AssetManagmentEquipmentOTListModel[@count1].OTMake" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTModel" name="AssetManagmentEquipmentOTListModel[@count1].OTModel" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTType" name="AssetManagmentEquipmentOTListModel[@count1].OTType" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTSerialNo" name="AssetManagmentEquipmentOTListModel[@count1].OTSerialNo" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTWorkingCondition" name="AssetManagmentEquipmentOTListModel[@count1].OTWorkingCondition" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTLastServiced" name="AssetManagmentEquipmentOTListModel[@count1].OTLastServiced" />
                                    </td>
                                    <td width="16%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTRemark" name="AssetManagmentEquipmentOTListModel[@count1].OTRemark" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTOwner" name="AssetManagmentEquipmentOTListModel[@count1].OTOwner" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTPersonResponsible" name="AssetManagmentEquipmentOTListModel[@count1].OTPersonResponsible" />
                                    </td>
                                    <td width="11%">
                                        <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentOTListModel[@count1].OTCriticality">
                                            <option value=""></option>
                                            @if (TempData["CriticalityList"] != null)
                                            {
                                                foreach (var items in (List<string>)TempData["CriticalityList"])
                                                {
                                                    <option @(!string.IsNullOrWhiteSpace(item.OTCriticality) && item.OTCriticality == items ? "selected" : "") value="@items">@items</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTOperatingSystem" name="AssetManagmentEquipmentOTListModel[@count1].OTOperatingSystem" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.OTOSPatchVersion" name="AssetManagmentEquipmentOTListModel[@count1].OTOSPatchVersion" />
                                    </td>
                                    @*<td width="2%" class="text-center aviodPrint">
                                        <p>
                                            <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                        </p>
                                    </td>*@
                                </tr>
                                            count1++;
                                        }
                                    }
                                </table>
                                <div class="col-md-12 text-center aviodPrint">
                                    <a href="#" id="lnkAddOTEquipment">Add OT EQUIPMENT</a>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="breakDivPage"></div>
                        <br />
                        <div class="breakDiv">
                            <div class="SectionContent">
                                <table class="table tblSection tblITEquipment">
                                    <thead>
                                        <tr>
                                            <td class="SectionHead text-center" colspan="16">
                                                IT EQUIPMENT
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="11%"><p class="m-5 text-center">HARDWARE ID</p></td>
                                            <td width="11%"><p class="m-5 text-center">EQUIPMENT</p></td>
                                            <td width="11%"><p class="m-5 text-center">LOCATION</p></td>
                                            <td width="11%"><p class="m-5 text-center">MAKE</p></td>
                                            <td width="11%"><p class="m-5 text-center">MODEL</p></td>
                                            <td width="10%"><p class="m-5 text-center">TYPE</p></td>
                                            <td width="11%"><p class="m-5 text-center">SERIAL NO</p></td>
                                            <td width="10%"><p class="m-5 text-center">WORKING CONDITION</p></td>
                                            <td width="7%"><p class="m-5 text-center">LAST SERVICED</p></td>
                                            <td width="16%"><p class="m-5 text-center">REMARKS</p></td>
                                            <td width="16%"><p class="m-5 text-center">OWNER</p></td>
                                            <td width="16%"><p class="m-5 text-center">PERSON RESPONSIBLE</p></td>
                                            <td width="16%"><p class="m-5 text-center">CRITICALITY</p></td>
                                            <td width="16%"><p class="m-5 text-center">OPERATING SYSTEM</p></td>
                                            <td width="16%"><p class="m-5 text-center">OS PATCH VERSION</p></td>
                                            @*<td width="2%" class="aviodPrint"></td>*@
                                        </tr>
                                    </thead>
                                    @if (@Model == null || @Model.AssetManagmentEquipmentITListModel == null || @Model.AssetManagmentEquipmentITListModel.Count <= 0)
                                    {
                                <tr class="records" index="0" IsSelected="true">
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="IT00001" name="AssetManagmentEquipmentITListModel[0].ITHardwareId" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITEquipment" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITLocation" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITMake" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITModel" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITType" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITSerialNo" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITWorkingCondition" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITLastServiced" />
                                    </td>
                                    <td width="16%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITRemark" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITOwner" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" name="AssetManagmentEquipmentITListModel[0].ITPersonResponsible" />
                                    </td>
                                    <td width="11%">
                                        <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentITListModel[0].ITCriticality">
                                            <option value=""></option>
                                            @if (TempData["CriticalityList"] != null)
                                            {
                                                foreach (var items in (List<string>)TempData["CriticalityList"])
                                                {
                                                    <option value="@items">@items</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData minWidthMedium" name="AssetManagmentEquipmentITListModel[0].ITOperatingSystem" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData minWidthMedium" name="AssetManagmentEquipmentITListModel[0].ITOSPatchVersion" />
                                    </td>
                                    @*<td width="2%" class="text-center aviodPrint">
                                        <p>
                                            <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                        </p>
                                    </td>*@
                                </tr>
                                    }
                                    else
                                    {
                                        int count2 = 0;
                                        foreach (var item in Model.AssetManagmentEquipmentITListModel)
                                        {
                                <tr class="records" index="@count2" IsSelected="true">
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value=" @(!string.IsNullOrEmpty(item.ITHardwareId) ? item.ITHardwareId :  "IT" + (count2+1).ToString().PadLeft(5,'0'))" name="AssetManagmentEquipmentITListModel[@count2].ITHardwareId" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITEquipment" name="AssetManagmentEquipmentITListModel[@count2].ITEquipment" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITLocation" name="AssetManagmentEquipmentITListModel[@count2].ITLocation" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITMake" name="AssetManagmentEquipmentITListModel[@count2].ITMake" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITModel" name="AssetManagmentEquipmentITListModel[@count2].ITModel" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITType" name="AssetManagmentEquipmentITListModel[@count2].ITType" />
                                    </td>
                                    <td width="11%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITSerialNo" name="AssetManagmentEquipmentITListModel[@count2].ITSerialNo" />
                                    </td>
                                    <td width="10%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITWorkingCondition" name="AssetManagmentEquipmentITListModel[@count2].ITWorkingCondition" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITLastServiced" name="AssetManagmentEquipmentITListModel[@count2].ITLastServiced" />
                                    </td>
                                    <td width="16%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITRemark" name="AssetManagmentEquipmentITListModel[@count2].ITRemark" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITOwner" name="AssetManagmentEquipmentITListModel[@count2].ITOwner" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData" value="@item.ITPersonResponsible" name="AssetManagmentEquipmentITListModel[@count2].ITPersonResponsible" />
                                    </td>
                                    <td width="11%">
                                        <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentITListModel[@count2].ITCriticality">
                                            <option value=""></option>
                                            @if (TempData["CriticalityList"] != null)
                                            {
                                                foreach (var items in (List<string>)TempData["CriticalityList"])
                                                {
                                                    <option @(!string.IsNullOrWhiteSpace(item.ITCriticality) && item.ITCriticality == items ? "selected" : "") value="@items">@items</option>
                                                }
                                            }
                                        </select>
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData minWidthMedium" value="@item.ITOperatingSystem" name="AssetManagmentEquipmentITListModel[@count2].ITOperatingSystem" />
                                    </td>
                                    <td width="7%">
                                        <input type="text" class="col-md-12 form-control AMEData minWidthMedium" value="@item.ITOSPatchVersion" name="AssetManagmentEquipmentITListModel[@count2].ITOSPatchVersion" />
                                    </td>
                                    @*<td width="2%" class="text-center aviodPrint">
                                        <p>
                                            <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                        </p>
                                    </td>*@
                                </tr>
                                            count2++;
                                        }
                                    }
                                </table>
                                <div class="col-md-12 text-center aviodPrint">
                                    <a href="#" id="lnkAddITEquipment">Add IT EQUIPMENT</a>
                                </div>
                            </div>
                        </div>
                        <br />
                        <div class="breakDivPage"></div>
                        <br />
                        <div class="breakDiv">
                            <div class="SectionContent">
                                <table class="table tblSection tblSoftwareAssets">
                                    <thead>
                                        <tr>
                                            <td class="SectionHead text-center" colspan="12">
                                                SOFTWARE ASSETS
                                            </td>
                                        </tr>
                                        <tr>
                                            <td width="8%"><p class="m-5 text-center">SOFTWARE ID</p></td>
                                            <td width="10%"><p class="m-5 text-center">NAME</p></td>
                                            <td width="10%"><p class="m-5 text-center">MANUFACTURER</p></td>
                                            <td width="10%"><p class="m-5 text-center">LICENSE TYPE</p></td>
                                            <td width="10%"><p class="m-5 text-center">CATEGORY</p></td>
                                            <td width="10%"><p class="m-5 text-center">IS ACTIVE</p></td>
                                            <td width="10%"><p class="m-5 text-center">OWNER</p></td>
                                            <td width="10%"><p class="m-5 text-center">PERSON RESPONSIBLE</p></td>
                                            <td width="10%"><p class="m-5 text-center">CRITICALITY</p></td>
                                            <td width="10%"><p class="m-5 text-center">OPERATING SYSTEM</p></td>
                                            <td width="10%"><p class="m-5 text-center">OS PATCH VERSION</p></td>
                                            @*<td width="2%" class="aviodPrint"></td>*@
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if (@Model != null && @Model.AssetManagmentEquipmentSoftwareAssetsModel != null && @Model.AssetManagmentEquipmentSoftwareAssetsModel.Count > 0)
                                        {
                                            int count2 = 0;
                                            foreach (var item in Model.AssetManagmentEquipmentSoftwareAssetsModel)
                                            {
                                        <tr class="records" index="@count2" IsSelected="true">
                                            <td width="8%">
                                                <input type="text" class="col-md-12 form-control AMEData" value=" @(!string.IsNullOrEmpty(item.SASoftwareId) ? item.SASoftwareId : "SA" + (count2+1).ToString().PadLeft(5,'0'))" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SASoftwareId" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.Name" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].Name" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.Manufacturer" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].Manufacturer" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.LicenseType" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].LicenseType" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.Category" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].Category" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.IsActive" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].IsActive" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.SAOwner" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SAOwner" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData" value="@item.SAPersonResponsible" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SAPersonResponsible" />
                                            </td>
                                            <td width="10%">
                                                <select disabled class="col-md-12 form-control AMEData minWidthSmall" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SACriticality">
                                                    <option value=""></option>
                                                    @if (TempData["CriticalityList"] != null)
                                                    {
                                                        foreach (var items in (List<string>)TempData["CriticalityList"])
                                                        {
                                                            <option @(!string.IsNullOrWhiteSpace(item.SACriticality) && item.SACriticality == items ? "selected" : "") value="@items">@items</option>
                                                        }
                                                    }
                                                </select>
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData minWidthMedium" value="@item.SAOperatingSystem" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SAOperatingSystem" />
                                            </td>
                                            <td width="10%">
                                                <input type="text" class="col-md-12 form-control AMEData minWidthMedium" value="@item.SAOSPatchVersion" name="AssetManagmentEquipmentSoftwareAssetsModel[@count2].SAOSPatchVersion" />
                                            </td>
                                            @*<td width="2%" class="text-center aviodPrint">
                                                <p>
                                                    <span class="m-5 text-center cursor-pointer"><i onclick="removeRecord(this)" class="fa fa-fw fa-remove"></i></span>
                                                </p>
                                            </td>*@
                                        </tr>
                                                count2++;
                                            }
                                        }
                                    </tbody>
                                </table>
                                <div class="col-md-12 text-center aviodPrint">
                                    <a href="#" id="lnkAddSoftwareAssets">Add Software Assets</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br />
        </div>
        <div class="row aviodPrint">
            <div class="col-md-1">
                <button type="submit" id="btnSubmit" class="btn btn-primary">Save</button>
            </div>
            <div class="col-md-1" style="padding-left: 0px;margin-right: -10px;">
                <button type="button" class="btn btn-primary" onclick="printDiv()">Print</button>
            </div>
            <div class="col-md-1" style="padding-left:0px;">
                <a href="#" onclick="exportAssets()" class="btn btn-primary"><i class="fa fa-file-excel-o"></i> Export</a>
            </div>
        </div>
        <div id="frmAssetManagementEquipmentContentPrint" style="display:none;">
            <table class="ParentTable" id="Printtable">
                <thead>
                    <tr>
                        <td style='border-width: 0px !important;'>
                            <div class="page-header-space">
                                <div class="text-center">
                                    <h3>Asset Management - IT & OT Equipment</h3>
                                </div>
                                <div class="text-right">
                                    <h4 id="h4ShipName">SHIP: @ShipApplication.BLL.Helpers.SessionManager.ShipName</h4>
                                </div>
                            </div>
                        </td>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </form>
</section>
